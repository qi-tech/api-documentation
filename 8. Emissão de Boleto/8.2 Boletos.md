# Boletos

Como mencionado anteriormente, o processamento de ocorrências de um boleto pode ser feito através de uma instrução JSON
ou através do upload de um CNAB. Os endpoints responsáveis por este processamento são:

* **[/multibank_instruction](?882#instrucao_json)**
* **[/multibank_cnab](?882#upload_cnab)**

Para ambos os casos o cliente deve executar um POST com o payload necessário para esta ação.
O formato de assinatura do header e do body desta
requisição é descrito em detalhes [aqui](?file=224).

## Request

### Instrução JSON <a name=instrucao_json></a>

- endpoint: /multibank_instruction
- method: POST
- body (antes de ser assinado):

```json
{
    "occurrences": [
        {
            "amount": 1000,
            "automatic_bankruptcy_protest": false,
            "bank_teller_instructions": "Não aceitar após vencimento",
            "beneficiary_account_key": "12345678-1234-49e4-b15b-7740038295a8",
            "beneficiary_key": "bf623fcf-6e03-42b7-8664-12345c8acddb",
            "days_to_bankruptcy_protest": 0,
            "document_number": "123456/01",
            "expiration": "2020-06-01",
            "fine_percentage": "3",
            "interest_daily_value": "0.34",
            "occurrence_type": "registration",
            "payer_address": "Rua Carlos Sampaio, 123",
            "payer_document": "12345678912",
            "payer_name": "João Ninguem",
            "payer_person_type": "natural",
            "payer_postal_code_root": "15800",
            "payer_postal_code_sufix": "020",
            "printing_policy": "no_printing",
            "registration_institution_enumerator": "qi_scd",
            "requester_profile": 1,
            "requester_profile_code": "329-01-0001-0000002"
        }
    ]
}
```
<br>

#### Atributos de uma instrução

O envio de uma instrução de boleto é composto apensar de:

- **`occurrences`** *(obrigatório)*: **[Lista de ocorrências](?882#lista-de-ocorrencias)** a serem processadas.

#### Lista de ocorrências <a name=lista-de-ocorrencias></a>

Cada objeto dentro da lista de ocorrências é composto de campos diversos, dependendo de qual o tipo de ocorrência
que será processada. Neste exemplo mostramos uma ocorrência de registro de boleto, seus campos são:

| Campo | Descrição | Exemplo
|---|---|---|
| **`amount`** | Valor do boleto | "1000" |
| **`automatic_bankruptcy_protest`** | Protesto automático | False |
| **`bank_teller_instructions`** | Instruções ao caixa | "0001" |
| **`beneficiary_account_key`**| Chave da conta do beneficiário | "12345678-1234-49e4-b15b-7740038295a8" |
| **`beneficiary_key`** | Chave do beneficiário | "12345fcf-6e03-42b7-8664-12345c8acddb" |
| **`days_to_bankruptcy_protest`** | Dias para protesto | 0 |
| **`document_number`** | Número de identificação do boleto | "123456/01" |
| **`expiration`** | Data de vencimento | "2020-06-01" |
| **`fine_percentage`** | Porcentagem de multa | "3" |
| **`interest_daily_value`** | Valor de juros por dia em real | "0.34" |
| **`occurrence_type`** | Tipo de ocorrência | "registration" |
| **`payer_address`** | Endereço do pagante | "Rua Carlos Sampaio, 123" |
| **`payer_document`** | Documento do pagante (CPF ou CNPJ) | "12345678912" |
| **`payer_name`** | Nome do pagante | "Jõao Ninguem" |
| **`payer_person_type`** | Tipo de pessoa pagante | "natural" |
| **`payer_postal_code_root`** | Os cinco primeiros digitos do CEP | "15800" |
| **`payer_postal_code_sufix`** | Os três digitos finais do CEP | "020" |
| **`printing_policy`** | Política de impressão do boleto | "no_printing" |
| **`registration_institution_enumerator`** | Enumerador da instituição de registro do boleto. (qi_scd ou bradesco) | "qi_scd" |
| **`requester_profile`** | Número da carteira | "01" |
| **`requester_profile_code`** | Código da carteira | "329-01-0001-0000002" |

É importante notar que neste objeto de registro temos alguns campos essenciais para o registro do boleto como por exemplo o 
código da carteira, o valor e a instituição de registro. Outros campos, como o valor de juros por dia (interest_daily_value),
caso não especificado será utilizado a configuração padrão da carteira. Além destes campos existem outros campos que o cliente
pode adicionar caso julgue necessário mas não são obrigatórios, como por exemplo informações sobre o fiador do pagamento.

### Upload de CNAB <a name=upload_cnab></a>

- endpoint: /multibank_cnab
- method: POST

Assim como no **[upload de documentos](?file=332)**, para o upload de um CNAB A chamada deve ser autenticada seguindo o padrão descrito na seção [AUTENTICAÇÃO E SEGURANÇA](?file=221). Com as seguintes ressalvas:

- O valor da variável **ContentMD5** deverá ser a *Hash MD5 do binário* arquivo a ser enviado
- O binário do arquivo deve ser enviado no corpo da request como um FormData utilizando como chave a string "file" e no valor o arquivo a ser enviado. (Este conteúdo não é encriptado)

<br>