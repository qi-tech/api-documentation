# Introdução

Toda a troca de informações entre API’s deverá utilizar o protocolo HTTPS[¹](#1) e uma assinatura  assimétrica[²](#2). Nosso modelo de implementação da assinatura é baseado no utilizado pela Amazon[³](#3), sendo a principal diferença o uso de chaves assimétricas que adicionam uma camada de não-repúdio na comunicação.

Toda a comunicação com a QI é assinada, tanto as requisições quanto as respostas, isso significa que existe um parâmetro nas mensagens que garante sua autenticidade. Para realizar tal assinatura, a QI usa um padrão com chaves assimétricas, portanto existem duas chaves diferentes, uma para assinatura (chave privada) e uma para leitura (chave pública). As assinaturas seguem o padrão JWT[⁴](#4) e o algoritmo de criptografia ECDSASHA512[⁵](#5) (Recomendamos FORTEMENTE a exploração do site https://jwt.io/, nele voê conseguirá validar JWTs e descobrir bibliotecas para lidar com esses tokens em basicamente qualquer linguagem moderna de programação).

O uso dessa combinação de tecnologias visa criar um canal de comunicação seguro e que garanta que as mensagens enviadas só poderiam vir de uma fonte que possui a chave privada para assiná-la. Por esse motivo o par de chaves pública-privada precisa ser criado de maneira independente por cada uma das partes e a chave privada deve ser guardada em segredo, não sendo divulgada para nenhum terceiro ou parte interessada, nem mesmo a QI.

**As mensagens trocadas com a QI sempre terão o header e o body HTTP assinados** de acordo com o especificado nas próximas subseções.
<br>
<br>

<sub><sup>
<a name=1>1</a>: Para encriptação da comunicação <br>
<a name=2>2</a>: Para autenticação e não-repúdio da informação <br>
<a name=3>3</a>: Literatura sugerida: Signing HTTP messages (https://datatracker.ietf.org/doc/draft-cavage-http-signatures/), Security Considerations for HTTP Signatures (https://web-payments.org/specs/source/http-signatures-audit/) e AWS Signing and Authenticating REST Requests (https://docs.aws.amazon.com/AmazonS3/latest/dev/RESTAuthentication.html) <br>
<a name=4>4</a>: JWT (JSON Web Token): https://jwt.io/ <br>
<a name=5>5</a>: Exemplo de geração de chaves em um computador UNIX:
</sub></sup>
```bash
$ ssh-keygen -t ecdsa -b 521 -m PEM -f jwtECDSASHA512.key
$ openssl ec -in jwtECDSASHA512.key -pubout -outform PEM -out jwtECDSASHA512.key.pub
```
<sub><sup>
A chave pública deverá estar em ~/.ssh/jwtECDSASHA512.key.pub
A chave privada deverá estar em ~/.ssh/jwtECDSASHA512.key
</sub></sup>
